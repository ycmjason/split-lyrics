<html>
  <head>
    <style>
      textarea{
        width: 45%;
        height: 90%;
        border: 1px solid #888; 
        outline: none;
        resize: none;
        overflow: auto;
        font-family: arial;
        font-size: 1.5em;
        line-height: 1.3em;
      }
    </style>
    <title>Split lyrics</title>
  </head>
  <body>
    <h1>Put the lyrics link in:</h1>
    <input id="url" type="text" placeholder="http://www.azlyrics.com/lyrics/johnmayer/xo.html">
    <button id="submit">submit</button>
    <div>
      <textarea autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" data-gramm_editor="false"></textarea>
      <textarea autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" data-gramm_editor="false"></textarea>
    </div>
<script>
if(!fetch){
  document.innerHTML('Please use a mordern browser or update your browser.');
  console.error('no fetch found');
}
document.getElementById('submit').addEventListener('click', submitUrl);
function submitUrl(){
  var url = document.getElementById('url').value;
  var endpoint = 'api/grabtext?url=' + url;
  fetch(endpoint).then(function(res){
    return res.json();
  }).then(function(res){
    populateTextboxes(res.text);
  });
}

function populateTextboxes(text){
  var texts = split(text);
  var textareas = document.querySelectorAll('textarea');
  textareas.forEach(function(textarea, i){
    textarea.value = texts[i];
  });
}

function split(s){
  // split according to line number
  var ps = s.split('\n\n');
  var ps1 = [];
  var ps2 = [];
  for(var i = 0; i < Math.floor(ps.length/2); i++){
    ps1.push(ps[i]);
  }
  for(var i = Math.floor(ps.length/2); i < ps.length; i++){
    ps2.push(ps[i]);
  }
  return [ps1.join('\n\n'), ps2.join('\n\n')];
}
</script>
  </body>
</html>
